groups:
- name: ArgoCDApplicationAlerts
  rules:
  - alert: WhiteListedApplicationOutOfSync
    annotations:
      summary: ArgoCD WhiteListed Application **{{ Labels.argocd_application_name }}**/**{{ Labels.application_namespace }}** is out of sync.
      description: The application **{{ Labels.argocd_application_name }}**/**{{ Labels.application_namespace }}** has been out of sync for more than 30 minutes.
    expr: argocd_application_sync_state{argocd_application_name!="", application_namespace!="", whitelisted="true", result="waiting"} == 1
    for: 30m
    labels:
      alert_id: WhiteListedApplicationOutOfSync
      severity: critical
  - alert: CronSyncFailed
    annotations:
      summary: ArgoCD WhiteListed Application **{{ Labels.argocd_application_name }}**/**{{ Labels.application_namespace }}** sync failed.
      description: The application**{{ Labels.argocd_application_name }}**/**{{ Labels.application_namespace }}** has been out of sync for more than 15 minutes.
    expr: argocd_application_sync_state{argocd_application_name!="", application_namespace!="", whitelisted="true", result="failed"} == 1
    for: 15m
    labels:
      alert_id: CronSyncFailed
      severity: critical
  # - alert: ApplicationOutOfSync
  #   annotations:
  #     summary: ArgoCD Application **{{ Labels.argocd_application_name }}**/**{{ Labels.application_namespace }}**  is out of sync.
  #     description: The application **{{ Labels.argocd_application_name }}**/ **{{ Labels.application_namespace }}** has been out of sync for more than 2 hours.
  #   expr: argocd_application_sync_state{argocd_application_name!="", application_namespace!="", whitelisted="false", result=""} == 1
  #   for: 5m  #30
  #   labels:
  #     alert_id: ApplicationOutOfSync
  #     severity: critical
  